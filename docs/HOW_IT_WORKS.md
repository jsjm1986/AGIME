# AGIME 工作原理

> 本文档用通俗的语言解释 AGIME 是如何工作的，帮助你更好地理解和使用它。

## 目录

- [简单理解](#简单理解)
- [对话是如何处理的](#对话是如何处理的)
- [AI 如何执行任务](#ai-如何执行任务)
- [记忆系统](#记忆系统)
- [食谱与自动化](#食谱与自动化)
- [安全机制](#安全机制)

---

## 简单理解

想象 AGIME 是你雇佣的一位智能助理：

```
┌─────────────────────────────────────────────────────┐
│                                                     │
│    你 ──────► AGIME ──────► 你的电脑               │
│   (说话)      (理解)        (执行)                 │
│                  │                                  │
│                  ▼                                  │
│              AI 大脑                                │
│           (云端或本地)                              │
│                                                     │
└─────────────────────────────────────────────────────┘
```

**工作流程**：
1. **你说话** - 用自然语言告诉 AGIME 你想做什么
2. **它理解** - AGIME 把你的话发送给 AI 模型理解意图
3. **它规划** - AI 思考需要哪些步骤来完成任务
4. **它执行** - AGIME 在你的电脑上执行这些步骤
5. **它汇报** - 把执行结果告诉你

---

## 对话是如何处理的

### 第一步：你发送消息

当你在输入框打字并发送：

```
你：帮我把桌面上的图片按日期整理到不同文件夹
```

### 第二步：构建上下文

AGIME 会把以下信息打包发送给 AI：

```
┌─────────────────────────────────────────┐
│ 发送给 AI 的内容                         │
├─────────────────────────────────────────┤
│ 1. 系统设定（告诉 AI 它是什么角色）       │
│ 2. 可用工具（AI 能调用哪些能力）          │
│ 3. 历史对话（之前聊过什么）               │
│ 4. 你的记忆（你的偏好习惯）               │
│ 5. 你刚才说的话                          │
└─────────────────────────────────────────┘
```

### 第三步：AI 思考并响应

AI 模型收到信息后，会思考并给出回应：

```
AI 的思考过程：
1. 用户想整理桌面图片
2. 需要先看看桌面有哪些图片
3. 然后获取每张图片的日期
4. 最后按日期创建文件夹并移动

AI 的回应：
"好的，我来帮你整理。首先让我看看桌面有哪些图片..."
[调用工具：列出桌面文件]
```

### 第四步：执行工具

当 AI 决定使用工具时，AGIME 会：

```
┌─────────────────────────────────────────┐
│           工具执行流程                   │
├─────────────────────────────────────────┤
│                                         │
│  AI 请求：列出桌面文件                   │
│      │                                  │
│      ▼                                  │
│  AGIME 检查权限                         │
│      │                                  │
│      ▼                                  │
│  [智能模式] 这是读取操作，自动允许       │
│      │                                  │
│      ▼                                  │
│  执行：读取 ~/Desktop 目录               │
│      │                                  │
│      ▼                                  │
│  返回结果给 AI                          │
│                                         │
└─────────────────────────────────────────┘
```

### 第五步：循环直到完成

AI 拿到工具的执行结果后，继续思考下一步，直到任务完成：

```
循环 1: 列出文件 → 发现 50 张图片
循环 2: 读取图片日期 → 获取到日期信息
循环 3: 创建文件夹 → 按月份创建 6 个文件夹
循环 4: 移动文件 → 把图片移到对应文件夹
完成: "已整理完成！50 张图片按月份分到了 6 个文件夹。"
```

---

## AI 如何执行任务

### 工具系统

AGIME 通过「工具」让 AI 能够操作你的电脑：

```
┌─────────────────────────────────────────────────────┐
│                    可用工具                          │
├─────────────────────────────────────────────────────┤
│                                                     │
│  📁 文件操作        🌐 网络操作        💻 系统操作   │
│  ├─ 读取文件        ├─ 访问网页        ├─ 运行程序   │
│  ├─ 写入文件        ├─ 下载文件        ├─ 执行命令   │
│  ├─ 移动文件        └─ API 请求       └─ 截图       │
│  └─ 删除文件                                        │
│                                                     │
│  🔧 开发工具        📊 数据处理        🧠 记忆系统   │
│  ├─ 代码分析        ├─ 表格处理        ├─ 保存记忆   │
│  ├─ 运行脚本        ├─ 图表生成        └─ 读取记忆   │
│  └─ Git 操作        └─ PDF 处理                     │
│                                                     │
└─────────────────────────────────────────────────────┘
```

### 工具调用示例

当你说「打开我的周报文档」：

```
你: 打开我的周报文档

AI 思考: 用户想打开周报文档，我需要：
1. 先找到这个文档
2. 然后用默认程序打开它

AI 行动:
┌────────────────────────────────────────┐
│ 工具调用 1: search_files               │
│ 参数: pattern="*周报*", path="~"       │
│ 结果: 找到 ~/Documents/工作/周报.docx  │
├────────────────────────────────────────┤
│ 工具调用 2: open_file                  │
│ 参数: path="~/Documents/工作/周报.docx"│
│ 结果: 已打开                           │
└────────────────────────────────────────┘

AI: 已经帮你打开了 ~/Documents/工作/周报.docx
```

---

## 记忆系统

### 为什么需要记忆

普通 AI 对话是「无状态」的——每次对话它都不记得你是谁。AGIME 的记忆系统改变了这一点。

### 记忆类型

```
┌─────────────────────────────────────────────────────┐
│                    记忆系统                          │
├─────────────────────────────────────────────────────┤
│                                                     │
│  📝 短期记忆（会话内）                               │
│     当前对话的上下文，关闭后清除                     │
│                                                     │
│  💾 长期记忆（跨会话）                               │
│     你的偏好、习惯、常用信息                         │
│     例如：                                          │
│     - "用户喜欢简洁的报告格式"                       │
│     - "用户的项目目录在 ~/Projects"                 │
│     - "用户习惯用 VS Code 打开代码"                 │
│                                                     │
└─────────────────────────────────────────────────────┘
```

### 记忆如何工作

```
对话 1:
你: 我的项目都放在 D:/Projects
AI: 好的，我记住了。[保存到记忆]

... 一周后 ...

对话 2:
你: 帮我看看最近的项目
AI: [读取记忆：项目目录在 D:/Projects]
    好的，让我看看 D:/Projects 下的项目...
```

---

## 食谱与自动化

### 什么是食谱

食谱是「可重复执行的工作流」。就像做菜的菜谱一样，记录了完成某个任务的步骤。

### 食谱示例

```yaml
# 周报生成食谱
name: 生成周报
description: 自动收集本周工作并生成周报

steps:
  - 读取本周的 Git 提交记录
  - 读取本周的会议记录
  - 读取本周的任务完成情况
  - 汇总并生成周报文档
  - 保存到指定位置
```

### 食谱 + 定时 = 自动化

```
┌─────────────────────────────────────────┐
│              自动化流程                  │
├─────────────────────────────────────────┤
│                                         │
│  食谱: 每日备份                          │
│    │                                    │
│    ▼                                    │
│  定时: 每天 18:00                        │
│    │                                    │
│    ▼                                    │
│  ┌─────────────────────────┐           │
│  │ 18:00 到了！             │           │
│  │ AGIME 自动执行食谱       │           │
│  │ → 备份重要文件           │           │
│  │ → 发送完成通知           │           │
│  └─────────────────────────┘           │
│                                         │
│  你什么都不用做，任务自动完成 ✓          │
│                                         │
└─────────────────────────────────────────┘
```

---

## 安全机制

### 四种工作模式

AGIME 提供四种模式来平衡便利性和安全性：

```
┌─────────────────────────────────────────────────────┐
│                                                     │
│  🟢 自主模式                                        │
│     AI 可以自由执行任何操作                         │
│     适合：完全信任的重复任务                        │
│                                                     │
│  🟡 智能模式 ⭐ 推荐                                │
│     低风险操作自动执行，高风险操作需确认            │
│     适合：日常使用                                  │
│                                                     │
│  🔴 手动模式                                        │
│     每一步操作都需要你确认                          │
│     适合：敏感操作、学习了解                        │
│                                                     │
│  ⚪ 聊天模式                                        │
│     只对话，不执行任何操作                          │
│     适合：纯咨询问答                                │
│                                                     │
└─────────────────────────────────────────────────────┘
```

### 风险分级

不同操作有不同的风险等级：

| 风险等级 | 操作类型 | 智能模式下 |
|----------|----------|------------|
| 🟢 低 | 读取文件、查看信息 | 自动执行 |
| 🟡 中 | 创建文件、网络请求 | 自动执行 |
| 🟠 较高 | 修改文件、执行命令 | 需要确认 |
| 🔴 高 | 删除文件、系统操作 | 强制确认 |

### 确认对话框

当需要确认时，你会看到：

```
┌─────────────────────────────────────────┐
│  ⚠️ 操作确认                             │
├─────────────────────────────────────────┤
│                                         │
│  AI 想要执行以下操作：                   │
│                                         │
│  📄 删除文件                             │
│     路径: ~/Downloads/temp.txt          │
│                                         │
│  ┌─────────┐  ┌─────────┐              │
│  │  允许   │  │  拒绝   │              │
│  └─────────┘  └─────────┘              │
│                                         │
│  □ 本次会话中不再询问此类操作            │
│                                         │
└─────────────────────────────────────────┘
```

---

## 数据安全

### 本地优先

```
┌─────────────────────────────────────────┐
│            数据存储位置                  │
├─────────────────────────────────────────┤
│                                         │
│  ✅ 存储在你的电脑上                     │
│     - 对话历史                          │
│     - 食谱配置                          │
│     - 记忆数据                          │
│     - 所有设置                          │
│                                         │
│  🔄 发送到 AI 服务（仅处理时）           │
│     - 当前对话内容                       │
│     - 仅用于 AI 理解和回复               │
│     - 处理完即丢弃                       │
│                                         │
│  ❌ 我们不收集                           │
│     - 任何个人数据                       │
│     - 任何使用记录                       │
│     - 任何文件内容                       │
│                                         │
└─────────────────────────────────────────┘
```

### 完全离线方案

如果你对隐私有更高要求，可以使用本地模型：

```
使用 Ollama + 本地模型
     │
     ▼
所有数据都在你的电脑上处理
     │
     ▼
没有任何数据离开你的设备
     │
     ▼
100% 隐私保护 ✓
```

---

## 总结

```
┌─────────────────────────────────────────────────────┐
│                                                     │
│  AGIME 工作原理总结                                 │
│                                                     │
│  1. 你说话 → AGIME 理解你的意图                     │
│  2. AI 思考 → 规划完成任务的步骤                    │
│  3. 工具执行 → 在你的电脑上执行操作                 │
│  4. 循环迭代 → 直到任务完成                         │
│  5. 学习记忆 → 越用越懂你                           │
│                                                     │
│  安全保障：                                         │
│  - 四种工作模式，灵活控制                           │
│  - 风险分级，高危操作需确认                         │
│  - 数据本地存储，隐私优先                           │
│                                                     │
└─────────────────────────────────────────────────────┘
```

---

<p align="center">
  <a href="./ARCHITECTURE.md">技术架构详解 →</a>
</p>

<p align="center">
  <a href="../README.md">← 返回主页</a>
</p>
